<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Hard work makes things easier."><title>Damon's Blog</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/5.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Damon's Blog</h1><a id="logo" href="/.">Damon's Blog</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/blogroll/"><i class="fa fa-rss"> Blogroll</i></a><a href="/msg/"><i class="fa fa-comments"> Msg</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h2 class="post-title"><a href="/2016/10/24/2016/2016-10-24-linux免密码命令/">linux免密码命令</a></h2><div class="post-meta">2016-10-24</div><a data-thread-key="2016/10/24/2016/2016-10-24-linux免密码命令/" href="/2016/10/24/2016/2016-10-24-linux免密码命令/#comments" class="ds-thread-count"></a><a data-disqus-identifier="2016/10/24/2016/2016-10-24-linux免密码命令/" href="/2016/10/24/2016/2016-10-24-linux免密码命令/#disqus_thread" class="disqus-comment-count"></a><div class="post-content"><p>在使用ubuntu的过程中，部分命令必须要具备root权限才可以执行，然后root权限需要输入密码，很多常用的命令如:reboot等，甚至需要每次输入密码，部分用户也许会很不满意。另外当如果在写脚本时也会出现这种问题，脚本中可能会包含一些sudo指令，但用户不想每次都输入密码。这边介绍几种方法以供参考。</p></div><p class="readmore"><a href="/2016/10/24/2016/2016-10-24-linux免密码命令/">Read More</a></p></div><div class="post"><h2 class="post-title"><a href="/2016/10/20/2016/2016-10-20-I2C通信详解/">I2C通信详解</a></h2><div class="post-meta">2016-10-20</div><a data-thread-key="2016/10/20/2016/2016-10-20-I2C通信详解/" href="/2016/10/20/2016/2016-10-20-I2C通信详解/#comments" class="ds-thread-count"></a><a data-disqus-identifier="2016/10/20/2016/2016-10-20-I2C通信详解/" href="/2016/10/20/2016/2016-10-20-I2C通信详解/#disqus_thread" class="disqus-comment-count"></a><div class="post-content"><p>在使用单片机的过程中，I2C 通信可以说是最被广泛使用和采纳的协议之一，采用 I2C 协议可以占用更少的资源，链接多台设备，因此它和 SPI 一样，在数字传感器中备受偏爱。</p>
<p>I²C（Inter-Integrated Circuit）字面上的意思是集成电路之间，它其实是 I²C Bus 简称，所以中文应该叫集成电路总线，它是一种串行通信总线，使用多主从架构，由飞利浦公司在1980年代为了让主板、嵌入式系统或手机用以连接低速周边设备而发展。I²C 的正确读法为“I平方C”（”I-squared-C”），而“I二C”（”I-two-C”）则是另一种错误但被广泛使用的读法。自2006年11月1日起，使用I²C协议已经不需要支付专利费，但制造商仍然需要付费以获取I²C从属设备地址。</p>
<p>I2C 主要用于电压、温度监控，EEPROM数据的读写，光模块的管理等。该总线只有两根线，SCL 和 SDA，SCL 即 Serial Clock，串行参考时钟，SDA 即 Serial Data，串行数据。</p>
<h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><h4 id="IO口"><a href="#IO口" class="headerlink" title="IO口"></a>IO口</h4><p>注意使用其他通讯协议时，你可能不需要特别注意 IO 的模式，但如果你使用的是模拟 I2C 的话，则最好关注下 IO 口模式设置。在 I2C 总线中有 2 个口线，SDA 和 SCL。这两个口线对为 OC 输出。</p>
<p>OC就是开漏输出(Open Collector)的简称，有时候也叫OD输出（Open-Drain），OD是对mos管而言，OC是对双极型管而言，在用法上没啥区别。相对于OC输出，另一种输出叫推挽输出(Push-Pull)，一般的MCU管脚输出可以设置这两种模式。这里分别介绍下这两种输出的不同点。</p>
<ul>
<li>推挽输出 : 可以输出高、低电平连接数字器件，推挽结构一般是指两个三极管分别受两互补信号的控制，总是在一个三极管导通的时候另一个截止.</li>
<li>开漏输出 : 输出端相当于三极管的集电极未接任何电平， 要得到高电平状态需要上拉电阻才行，适合于做电流型的驱动,其吸收电流的能力相对强(一般20ma以内)。</li>
</ul>
<p>对于MCU的开发者来讲，简单的这样理解就可以了。如果管脚设置成推挽输出模式，输出高时，IO口相当于VCC, 输出低时IO口相当于接地。如果管脚设置成开漏输出模式，输出高时，IO口的电平会和与其相连的口线进行与操作，如果都为高，才会被上拉拉成高电平，输出为低时，也相当于接地。</p>
<p>在网上我们看到很多的例程代码都是直接设置IO口的高低电平，这样做其实是不太合理的。因为我们只满足了 I2C 总线在自己这端的时序要求。而没有考虑到连接在总线上的其他器件。如果总线上其他器件的电平和MCU输出的电平一致，这样做是没问题的，如果两边的电平不一致时，这样做就有一定风险造成IO的损坏。当你输出高时，相当于IO口连接到VCC，如果对方这是恰好输出的是低电平，那就相当于短路了。因为 I2C 总线要实现线与的功能，所以 SDA 和 SCL 口线都必须设置为开漏输出模式，这种方式也是最安全的模式。我们使用 MCU 的硬件 I2C 接口时，口线会被自动设置成开漏。但有时候我们会使用 IO 口来模拟 I2C 总线，这个时候我们如何设置口线呢?</p>
<p>因为 I2C 的总线是开漏输出的，总线上接上上拉电阻后，SCL 和 SDA 就变成了高电平，这个时候挂接在总线上的任意一个 I2C 主机口可以把 SDA 拉低，即产生了一个 START 信号，挂接在总线上的其他 I2C 主机检测到这个信号后就不能去操作 I2C 总线了，否则会发生冲突。直到检测到一个 STOP 信号为止。STOP 的信号是在 SCL 口线为高时，SDA 产生一个上升沿。STOP 信号之后，I2C总线恢复到初始状态。</p>
<p>这里要分两种情况，如果MCU的口线支持开漏输出模式，则可以直接把 SDA 和 SCL 设置成开漏输出。例如 Silicon 的 C8051 系列 MCU，它的口线就支持开漏和推挽输出。如果 MCU 不支持开漏输出，例如 MSP430。当然如果软件做的合理，是可以避免这样的事情的，但总线上的很多器件都不是由你能控制的，如何设计出更合理的软件来避免这样的问题发生呢？对于不支持开漏输出MCU，我们最合理的做法是，当设置口线电平为高时，我们把口线设置成输入状态，然后利用口线上的上拉电阻来把口线拉高。这样即使是两边电平不一致时，也不会造成IO口的损坏。</p>
<h4 id="速度"><a href="#速度" class="headerlink" title="速度"></a>速度</h4><p>常见的I²C总线依传输速率的不同而有不同的模式：标准模式（100 Kbit/s）、低速模式（10 Kbit/s），但时钟频率可被允许下降至零，这代表可以暂停通信。而新一代的I²C总线可以和更多的节点（支持10比特长度的地址空间）以更快的速率通信：快速模式（400 Kbit/s）、高速模式（3.4 Mbit/s）。</p>
<h4 id="连线"><a href="#连线" class="headerlink" title="连线"></a>连线</h4><p><img src="https://raw.githubusercontent.com/noparkinghere/noparkinghere.github.io/master/img/2016-10-20-I2C通信详解/1.png" alt=""></p>
<p>如上图所示，I2C 是 OC 或 OD 输出结构，使用时必须在芯片外部进行上拉，上拉电阻R的取值根据 I2C 总线上所挂器件数量及 I2C 总线的速率有关，一般是标准模式下 R 选择 10kohm，快速模式下 R 选取 1kohm，I2C 总线上挂的 I2C 器件越多，就要求 I2C 的驱动能力越强，R 的取值就要越小，实际设计中，一般是先选取 4.7kohm 上拉电阻，然后在调试的时候根据实测的 I2C 波形再调整 R 的值。</p>
<p>I²C 只有两根通讯线：数据线 SDA 和时钟 SCL，可发送和接收数据。I2C 总线在传送数据过程中共有三种类型信号， 它们分别是：</p>
<ul>
<li>开始信号： SCL 为高电平时， SDA 由高电平向低电平跳变，开始传送数据。</li>
<li>结束信号： SCL 为高电平时， SDA 由低电平向高电平跳变，结束传送数据。</li>
<li>应答信号：接收数据的 IC 在接收到 8bit 数据后，向发送数据的 IC 发出特定的低电平脉冲，表示已收到数据。 CPU 向受控单元发出一个信号后，等待受控单元发出一个应答信号， CPU 接收到应答信号后，根据实际情况作出是否继续传递信号的判断。若未收到应答信号，由判断为受控单元出现故障。</li>
</ul>
<p>具体时序如下图所示：</p>
<p><img src="https://raw.githubusercontent.com/noparkinghere/noparkinghere.github.io/master/img/2016-10-20-I2C通信详解/2.png" alt=""></p>
<p>I2C总线的主要时序参数有：开始建立时间 t(SUSTA)，开始保持时间 t(HDSTA)，数据建立时间 t(SUDAT)，数据保持时间 t(SUDAT) ，结束建立时间 t(SUSTO) 。</p>
<ul>
<li>开始建立时间：SCL 上升至幅度的90%与SDA下降至幅度的90%之间的时间间隔；</li>
<li>开始保持时间：SDA下降至幅度的10%与SCL下降至幅度的10%之间的时间间隔；</li>
<li>数据建立时间：SDA上升至幅度的90%或SDA下降至幅度的10%与SCL上升至幅度的10%之间的时间间隔；</li>
<li>数据保持时间：SCL下降至幅度的10%与SDA上升至幅度的10%或SDA下降至幅度的90%之间的时间间隔；</li>
<li><p>结束建立时间：SCL上升至幅度的90%与SDA上升至幅度的90%之间的时间间隔；</p>
</li>
<li><p>I2C总线传输的特点：I2C总线按字节传输，即每次传输8bits二进制数据，传输完毕后等待接收端的应答信号ACK，收到应答信号后再传输下一字节。等不到ACK信号后，传输终止。空闲情况下，SCL和SDA都处于高电平状态。</p>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/noparkinghere/noparkinghere.github.io/master/img/2016-10-20-I2C通信详解/3.png" alt=""></p>
<ul>
<li>判断一次传输的开始：如上图所示，I2C总线传输开始的标志是：SCL信号处于高电平期间，SDA信号出现一个由高电平向低电平的跳变。</li>
</ul>
<p><img src="https://raw.githubusercontent.com/noparkinghere/noparkinghere.github.io/master/img/2016-10-20-I2C通信详解/4.png" alt=""></p>
<ul>
<li>判断一次传输的结束:如上图所示，I2C总线传输结束的标志是：SCL信号处于高电平期间，SDA信号出现一个由低电平向高电平的跳变。跟开始标识正好相反。</li>
</ul>
<p><img src="https://raw.githubusercontent.com/noparkinghere/noparkinghere.github.io/master/img/2016-10-20-I2C通信详解/5.png" alt=""></p>
<ul>
<li>有效数据:在SCL处于高电平期间，SDA保持状态稳定的数据才是有效数据，只有在SCL处于低电平状态时，SDA才允许状态切换。前面已经讲过了，SCL高电平期间，SDA状态发生改变，是传输开始/.结束的标志。</li>
</ul>
<h4 id="读写"><a href="#读写" class="headerlink" title="读写"></a>读写</h4><p><img src="https://raw.githubusercontent.com/noparkinghere/noparkinghere.github.io/master/img/2016-10-20-I2C通信详解/6.png" alt=""></p>
<p><img src="https://raw.githubusercontent.com/noparkinghere/noparkinghere.github.io/master/img/2016-10-20-I2C通信详解/7.png" alt=""></p>
<p>如上图所示，I2C开始传输时，第一个字节的前7bit是地址信息(7位地址器件)，第8bit是操作标识，为“0”时表示写操作，为“1”时表示读操作，第9个时钟周期是应答信号ACK，低有效，高电平表示无应答，传输终止。在上图中还可以看出，正常情况下，写操作是I2C主设备方发起终止操作的，而读操作时，I2C主控制器在接收完最后一个数据后，不对从设备进行应答，传输终止。</p>
<p>I2C数据总线SDA是在时钟为高时有效，在时钟SCL为高期间，SDA如果发生了电平变化就会终止或重启I2C中线，所以我们在数据传输过程中，要在SCL为低的时候去更改SDA的电平。</p>
<h4 id="总线信号时序"><a href="#总线信号时序" class="headerlink" title="总线信号时序"></a>总线信号时序</h4><p>再次总结下总线的各种时序状态：</p>
<ul>
<li>总线空闲状态：SDA 和 SCL 两条信号线都处于高电平，即总线上所有的器件都释放总线，两条信号线各自的上拉电阻把电平拉高；</li>
<li>启动信号 START：信号 SCL 保持高电平，数据信号SDA的电平被拉低(即负跳变)。启动信号必须是跳变信号，而且在建立该信号前必修保证总线处于空闲状态；</li>
<li>停止信号 STOP：时钟信号SCL保持高电平，数据线被释放，使得SDA返回高电平(即正跳变)，停止信号也必须是跳变信号。</li>
<li>数据传送：SCL 线呈现高电平期间，SDA 线上的电平必须保持稳定，低电平表示 0 (此时的线电压为地电压)，高电平表示1(此时的电压由元器件的VDD决定)。只有在 SCL 线为低电平期间，SDA 上的电平允许变化。</li>
<li>应答信号 ACK：I2C 总线的数据都是以字节( 8 位)的方式传送的，发送器件每发送一个字节之后，在时钟的第9个脉冲期间释放数据总线，由接收器发送一个ACK(把数据总线的电平拉低)来表示数据成功接收。</li>
<li>无应答信号 NACK：在时钟的第 9 个脉冲期间发送器释放数据总线，接收器不拉低数据总线表示一个 NACK，NACK 有两种用途:<br>a. 一般表示接收器未成功接收数据字节；<br>b. 当接收器是主控器时，它收到最后一个字节后，应发送一个 NACK 信号，以通知被控发送器结束数据发送，并释放总线，以便主控接收器发送一个停止信号 STOP。</li>
</ul>
<p><em>起始信号是必需的，结束信号和应答信号，都可以不要。</em></p>
<h3 id="模拟-I2C"><a href="#模拟-I2C" class="headerlink" title="模拟 I2C"></a>模拟 I2C</h3><p>目前大部分 MCU 都带有 I2C 总线接口，但是芯片自带的 I2C 也有两个问题，一个是移植性较差不够通用，另外部分 MCU 不带 I2C 还是得要模拟的方式，以及一些芯片设计的 I2C 据说是存在问题的，如： stm32 的 I2C 不够稳定，efm32 的 I2C 不够节能等等。这边建议，在权衡 I2C 占用的 CPU 资源是否可以承受后，再做选择。</p>
<p>以下以 EFM32 为例，给出参考代码，这边的代码只需要修改部分宏定义，就可以直接移植到 STM32 等其他单片机上。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* iic相关引脚定义 */</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> IIC_SDA_PORT      gpioPortA  </span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> IIC_SDA_PIN        0  </span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> IIC_SCL_PORT      gpioPortA  </span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> IIC_SCL_PIN        1</span></div><div class="line"></div><div class="line"><span class="comment">/* iic相关功能函数定义 */</span></div><div class="line"><span class="comment">//I2C_SDA PC0 --&gt; IIC_SDA=1;</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> IIC_SDA_HIGH()      GPIO_PinOutSet(IIC_SDA_PORT, IIC_SDA_PIN)  </span></div><div class="line"><span class="comment">//I2C_SCL PC1 --&gt; IIC_SCL=1;</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> IIC_SCL_HIGH()      GPIO_PinOutSet(IIC_SCL_PORT, IIC_SCL_PIN)</span></div><div class="line"><span class="comment">//I2C_SDA PC0 --&gt; IIC_SDA=0;</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> IIC_SDA_LOW()      GPIO_PinOutClear(IIC_SDA_PORT, IIC_SDA_PIN)</span></div><div class="line"><span class="comment">//I2C_SCL PC1 --&gt; IIC_SCL=0;</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> IIC_SCL_LOW()      GPIO_PinOutClear(IIC_SCL_PORT, IIC_SCL_PIN)</span></div><div class="line"><span class="comment">//设置SDA为输入</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> IIC_SDA_DISABLE()  GPIO_PinModeSet(IIC_SDA_PORT, IIC_SDA_PIN, gpioModeDisabled, 0)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> IIC_SCL_DISABLE()  GPIO_PinModeSet(IIC_SCL_PORT, IIC_SCL_PIN, gpioModeDisabled, 0)</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> IIC_SCL_SET_OUT()    GPIO_PinModeSet(IIC_SCL_PORT, IIC_SCL_PIN, gpioModePushPull, 0)</span></div><div class="line"></div><div class="line"><span class="comment">//设置为推挽输出模式</span></div><div class="line"><span class="comment">//#define IIC_SDA_SET_OUT()    GPIO_PinModeSet(IIC_SDA_PORT, IIC_SDA_PIN, gpioModePushPull, 0)</span></div><div class="line"><span class="comment">//设置为推开漏出模式</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> IIC_SDA_SET_OUT()    GPIO_PinModeSet(IIC_SDA_PORT, IIC_SDA_PIN, gpioModeWiredAndDrive, 0)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> IIC_SDA_SET_IN()    GPIO_PinModeSet(IIC_SDA_PORT, IIC_SDA_PIN, gpioModeInput, 0)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> IIC_SDA_INPUT()      GPIO_PinInGet(IIC_SDA_PORT, IIC_SDA_PIN)</span></div><div class="line"></div><div class="line"><span class="comment">/* 初始化IIC */</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">IIC_Init</span><span class="params">(<span class="keyword">void</span>)</span></div><div class="line"></span>&#123;</div><div class="line">  <span class="comment">//设置为推挽输出模式</span></div><div class="line">  IIC_SDA_SET_OUT();  </div><div class="line">  IIC_SCL_SET_OUT();    </div><div class="line"></div><div class="line">  <span class="comment">//I2C_SDA PC0 --&gt; IIC_SDA=1;</span></div><div class="line">  IIC_SDA_HIGH();</div><div class="line">  <span class="comment">//I2C_SCL PC1 --&gt; IIC_SCL=1;</span></div><div class="line">  IIC_SCL_HIGH();</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/* 产生IIC起始信号 */</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">IIC_Start</span><span class="params">(<span class="keyword">void</span>)</span></div><div class="line"></span>&#123;</div><div class="line">  u8 i;</div><div class="line">  <span class="comment">//IIC_SDA设置为推挽输出</span></div><div class="line">  IIC_SDA_SET_OUT();</div><div class="line">  </div><div class="line">  <span class="comment">//I2C_SDA PC0 --&gt; IIC_SDA=1;</span></div><div class="line">  IIC_SDA_HIGH();</div><div class="line">  <span class="comment">//I2C_SCL PC1 --&gt; IIC_SCL=1;</span></div><div class="line">  IIC_SCL_HIGH();</div><div class="line"></div><div class="line">  i = <span class="number">5</span>;</div><div class="line">  <span class="keyword">while</span>(i--);                               <span class="comment">//setup time for stop 4us</span></div><div class="line">  </div><div class="line">  <span class="comment">//I2C_SDA PC0 --&gt; IIC_SDA=0;</span></div><div class="line">  IIC_SDA_LOW();</div><div class="line">  </div><div class="line">  i = <span class="number">5</span>;</div><div class="line">  <span class="keyword">while</span>(i--);                               <span class="comment">//setup time for stop 4us</span></div><div class="line">  </div><div class="line">  <span class="comment">//I2C_SCL PC1 --&gt; IIC_SCL=0;</span></div><div class="line">  IIC_SCL_LOW();</div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="comment">//产生IIC停止信号</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">IIC_Stop</span><span class="params">(<span class="keyword">void</span>)</span></div><div class="line"></span>&#123;</div><div class="line">  u8 i;</div><div class="line">  <span class="comment">//IIC_SDA设置为推挽输出</span></div><div class="line">  IIC_SDA_SET_OUT();</div><div class="line">  </div><div class="line">  <span class="comment">//I2C_SCL PC1 --&gt; IIC_SCL=0;</span></div><div class="line">  IIC_SCL_LOW();</div><div class="line">  <span class="comment">//I2C_SDA PC0 --&gt; IIC_SDA=0;</span></div><div class="line">  IIC_SDA_LOW();</div><div class="line">    </div><div class="line">  i = <span class="number">5</span>;</div><div class="line">  <span class="keyword">while</span>(i--);                               <span class="comment">//setup time for stop 4us</span></div><div class="line">  </div><div class="line">  <span class="comment">//I2C_SCL PC1 --&gt; IIC_SCL=1;</span></div><div class="line">  IIC_SCL_HIGH();</div><div class="line">  <span class="comment">//I2C_SDA PC0 --&gt; IIC_SDA=1;</span></div><div class="line">  IIC_SDA_HIGH();</div><div class="line"></div><div class="line">  i = <span class="number">5</span>;</div><div class="line">  <span class="keyword">while</span>(i--);                               <span class="comment">//setup time for stop 4us                 </span></div><div class="line">&#125;</div><div class="line"><span class="comment">//主机接收从机应答信号</span></div><div class="line"><span class="comment">//等待应答信号到来</span></div><div class="line"><span class="comment">//返回值：1，接收应答失败</span></div><div class="line"><span class="comment">//        0，接收应答成功</span></div><div class="line"><span class="function">u8 <span class="title">IIC_Wait_Ack</span><span class="params">(<span class="keyword">void</span>)</span></div><div class="line"></span>&#123;</div><div class="line">  u8 ucErrTime=<span class="number">0</span>;</div><div class="line">  </div><div class="line">  <span class="comment">//SDA设置为输入</span></div><div class="line">  IIC_SDA_SET_IN();</div><div class="line"></div><div class="line">  <span class="comment">//I2C_SDA PC0 --&gt; IIC_SDA=1;</span></div><div class="line">  IIC_SDA_HIGH();</div><div class="line">  </div><div class="line">  __nop();</div><div class="line">  </div><div class="line">  <span class="comment">//I2C_SCL PC1 --&gt; IIC_SCL=1;</span></div><div class="line">  IIC_SCL_HIGH();</div><div class="line">  </div><div class="line">  __nop();</div><div class="line">  <span class="keyword">while</span>(IIC_SDA_INPUT())</div><div class="line">  &#123;</div><div class="line">    ucErrTime++;</div><div class="line">    <span class="keyword">if</span>(ucErrTime&gt;<span class="number">250</span>)</div><div class="line">    &#123;</div><div class="line">      IIC_Stop();</div><div class="line">      <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="comment">//I2C_SCL PC1 --&gt; IIC_SCL=0;</span></div><div class="line">  IIC_SCL_LOW();  </div><div class="line">  <span class="keyword">return</span> <span class="number">0</span>;  </div><div class="line">&#125; </div><div class="line"></div><div class="line"><span class="comment">//主机发送给从机应答信号</span></div><div class="line"><span class="comment">//产生ACK应答</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">IIC_Ack</span><span class="params">(<span class="keyword">void</span>)</span></div><div class="line"></span>&#123;</div><div class="line">  <span class="comment">//I2C_SCL PC1 --&gt; IIC_SCL=0;</span></div><div class="line">  IIC_SCL_LOW();  </div><div class="line">  <span class="comment">//IIC_SDA设置为推挽输出</span></div><div class="line">  IIC_SDA_SET_OUT();</div><div class="line">  </div><div class="line">  <span class="comment">//I2C_SDA PC0 --&gt; IIC_SDA=0;</span></div><div class="line">  IIC_SDA_LOW();</div><div class="line">  __nop();</div><div class="line">  </div><div class="line">  <span class="comment">//I2C_SCL PC1 --&gt; IIC_SCL=1;</span></div><div class="line">  IIC_SCL_HIGH();</div><div class="line">  __nop();</div><div class="line">  </div><div class="line">  <span class="comment">//I2C_SCL PC1 --&gt; IIC_SCL=0;</span></div><div class="line">  IIC_SCL_LOW();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//主机发送给从机应答信号</span></div><div class="line"><span class="comment">//不产生ACK应答        </span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">IIC_NAck</span><span class="params">(<span class="keyword">void</span>)</span></div><div class="line"></span>&#123;</div><div class="line">  <span class="comment">//I2C_SCL PC1 --&gt; IIC_SCL=0;</span></div><div class="line">  IIC_SCL_LOW();</div><div class="line">  <span class="comment">//IIC_SDA设置为推挽输出</span></div><div class="line">  IIC_SDA_SET_OUT();  </div><div class="line">  </div><div class="line">  <span class="comment">//I2C_SDA PC0 --&gt; IIC_SDA=1;</span></div><div class="line">  IIC_SDA_HIGH();</div><div class="line">  __nop();</div><div class="line">  </div><div class="line">  <span class="comment">//I2C_SCL PC1 --&gt; IIC_SCL=1;</span></div><div class="line">  IIC_SCL_HIGH();</div><div class="line">  </div><div class="line">  __nop();</div><div class="line">  </div><div class="line">  <span class="comment">//I2C_SCL PC1 --&gt; IIC_SCL=0;</span></div><div class="line">  IIC_SCL_LOW();</div><div class="line">&#125;                        </div><div class="line"><span class="comment">//IIC发送一个字节</span></div><div class="line"><span class="comment">//返回从机有无应答</span></div><div class="line"><span class="comment">//1，有应答</span></div><div class="line"><span class="comment">//0，无应答        </span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">IIC_Send_Byte</span><span class="params">(u8 txd)</span></div><div class="line"></span>&#123;                        </div><div class="line">    u8 t;   </div><div class="line">  </div><div class="line">  <span class="comment">//IIC_SDA设置为推挽输出</span></div><div class="line">  IIC_SDA_SET_OUT();  </div><div class="line">     </div><div class="line">  <span class="comment">//I2C_SCL PC1 --&gt; IIC_SCL=0;</span></div><div class="line">  IIC_SCL_LOW();</div><div class="line">  </div><div class="line">    <span class="keyword">for</span>(t=<span class="number">0</span>;t&lt;<span class="number">8</span>;t++)</div><div class="line">    &#123;              </div><div class="line">    <span class="comment">//I2C_SDA PC0 --&gt; IIC_SDA输出数据</span></div><div class="line">        <span class="keyword">if</span> (((txd&amp;<span class="number">0x80</span>)&gt;&gt;<span class="number">7</span>) &amp; <span class="number">1</span>)</div><div class="line">    &#123;</div><div class="line">      IIC_SDA_HIGH();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> </div><div class="line">    &#123;</div><div class="line">      IIC_SDA_LOW();  </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">        txd&lt;&lt;=<span class="number">1</span>;     </div><div class="line">    __nop();   <span class="comment">//对TEA5767这三个延时都是必须的</span></div><div class="line">    </div><div class="line">    <span class="comment">//I2C_SCL PC1 --&gt; IIC_SCL=1;</span></div><div class="line">    IIC_SCL_HIGH();</div><div class="line">    __nop(); </div><div class="line">    </div><div class="line">    <span class="comment">//I2C_SCL PC1 --&gt; IIC_SCL=0;</span></div><div class="line">    IIC_SCL_LOW();</div><div class="line">    __nop();</div><div class="line">    &#125;</div><div class="line">&#125;       </div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//读1个字节，ack=1时，发送ACK，ack=0，发送nACK   </span></div><div class="line"><span class="function">u8 <span class="title">IIC_Read_Byte</span><span class="params">(u8 ack)</span></div><div class="line"></span>&#123;</div><div class="line">  u8 i, receive=<span class="number">0</span>;</div><div class="line">  </div><div class="line">  <span class="comment">//SDA设置为输入</span></div><div class="line">  IIC_SDA_SET_IN();</div><div class="line"></div><div class="line">  </div><div class="line">  </div><div class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</div><div class="line">  &#123;</div><div class="line">    <span class="comment">//I2C_SCL PC1 --&gt; IIC_SCL=0;</span></div><div class="line">    IIC_SCL_LOW();</div><div class="line">    __nop();</div><div class="line">    <span class="comment">//I2C_SCL PC1 --&gt; IIC_SCL=1;</span></div><div class="line">    IIC_SCL_HIGH();</div><div class="line">        receive &lt;&lt;= <span class="number">1</span>;</div><div class="line">    </div><div class="line">        <span class="keyword">if</span>(IIC_SDA_INPUT())</div><div class="line">      receive++;   </div><div class="line">      </div><div class="line">    __nop(); </div><div class="line">    &#125;</div><div class="line">  </div><div class="line">  __nop(); </div><div class="line"></div><div class="line">  ack ? IIC_Ack() : IIC_NAck();</div><div class="line">  </div><div class="line">    <span class="keyword">return</span> receive;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="自带-I2C"><a href="#自带-I2C" class="headerlink" title="自带 I2C"></a>自带 I2C</h3><p>这边仅以 stm32 平台通过 I2C 总线读取 EEPROM 为例，说明下如何通过芯片自带 I2C 功能来通信。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#define  EEP_Firstpage      0x00</span></div><div class="line"></div><div class="line">u8 I2c_Buf_Write[256];</div><div class="line">u8 I2c_Buf_Read[256];</div><div class="line"></div><div class="line">static void I2C_GPIO_Config(void)</div><div class="line">&#123;</div><div class="line">  GPIO_InitTypeDef  GPIO_InitStructure; </div><div class="line"></div><div class="line">  /* 使能与 I2C1 有关的时钟 */</div><div class="line">  RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOB,ENABLE);</div><div class="line">  RCC_APB1PeriphClockCmd(RCC_APB1Periph_I2C1,ENABLE);  </div><div class="line">    </div><div class="line">  /* PB6-I2C1_SCL、PB7-I2C1_SDA*/</div><div class="line">  GPIO_InitStructure.GPIO_P<span class="keyword">in</span> =  GPIO_Pin_6 | GPIO_Pin_7;</div><div class="line">  GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</div><div class="line">  GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF_OD;	       // 开漏输出</div><div class="line">  GPIO_Init(GPIOB, &amp;GPIO_InitStructure);</div><div class="line">&#125;</div><div class="line"></div><div class="line">static void I2C_Mode_Configu(void)</div><div class="line">&#123;</div><div class="line">  I2C_InitTypeDef  I2C_InitStructure; </div><div class="line"></div><div class="line">  /* I2C 配置 */</div><div class="line">  I2C_InitStructure.I2C_Mode = I2C_Mode_I2C;</div><div class="line">  I2C_InitStructure.I2C_DutyCycle = I2C_DutyCycle_2;</div><div class="line">  I2C_InitStructure.I2C_OwnAddress1 =I2C1_OWN_ADDRESS7; </div><div class="line">  I2C_InitStructure.I2C_Ack = I2C_Ack_Enable ;</div><div class="line">  I2C_InitStructure.I2C_AcknowledgedAddress = I2C_AcknowledgedAddress_7bit;</div><div class="line">  I2C_InitStructure.I2C_ClockSpeed = I2C_Speed;</div><div class="line">  </div><div class="line">  /* 使能 I2C1 */</div><div class="line">  I2C_Cmd(I2C1, ENABLE);</div><div class="line"></div><div class="line">  /* I2C1 初始化 */</div><div class="line">  I2C_Init(I2C1, &amp;I2C_InitStructure);   </div><div class="line">&#125;</div><div class="line"></div><div class="line">void I2C_EE_Init(void)</div><div class="line">&#123;</div><div class="line"></div><div class="line">  I2C_GPIO_Config(); </div><div class="line"> </div><div class="line">  I2C_Mode_Configu();</div><div class="line"></div><div class="line">  /* 选择 EEPROM Block0 来写入 */</div><div class="line">  EEPROM_ADDRESS = EEPROM_Block0_ADDRESS;</div><div class="line">&#125;</div><div class="line"></div><div class="line">void I2C_EE_BufferWrite(u8* pBuffer, u8 WriteAddr, u16 NumByteToWrite)</div><div class="line">&#123;</div><div class="line">  u8 NumOfPage = 0, NumOfSingle = 0, Addr = 0, count = 0;</div><div class="line"></div><div class="line">  Addr = WriteAddr % I2C_PageSize;</div><div class="line">  count = I2C_PageSize - Addr;</div><div class="line">  NumOfPage =  NumByteToWrite / I2C_PageSize;</div><div class="line">  NumOfSingle = NumByteToWrite % I2C_PageSize;</div><div class="line"></div><div class="line">  I2C_EE_PageWrite(pBuffer, WriteAddr, NumOfSingle);</div><div class="line">  I2C_EE_WaitEepromStandbyState();</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">void I2C_EE_PageWrite(u8* pBuffer, u8 WriteAddr, u8 NumByteToWrite)</div><div class="line">&#123;</div><div class="line">    <span class="keyword">while</span>(I2C_GetFlagStatus(I2C1, I2C_FLAG_BUSY)); // Added by Najoua 27/08/2008</div><div class="line">    </div><div class="line">  /* Send START condition */</div><div class="line">  I2C_GenerateSTART(I2C1, ENABLE);</div><div class="line">  </div><div class="line">  /* Test on EV5 and clear it */</div><div class="line">  <span class="keyword">while</span>(!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_MODE_SELECT)); </div><div class="line">  </div><div class="line">  /* Send EEPROM address <span class="keyword">for</span> write */</div><div class="line">  I2C_Send7bitAddress(I2C1, EEPROM_ADDRESS, I2C_Direction_Transmitter);</div><div class="line">  </div><div class="line">  /* Test on EV6 and clear it */</div><div class="line">  <span class="keyword">while</span>(!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED));  </div><div class="line"></div><div class="line">  /* Send the EEPROM<span class="string">'s internal address to write to */    </div><div class="line">  I2C_SendData(I2C1, WriteAddr);  </div><div class="line"></div><div class="line">  /* Test on EV8 and clear it */</div><div class="line">  while(! I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_TRANSMITTED));</div><div class="line"></div><div class="line">  /* While there is data to be written */</div><div class="line">  while(NumByteToWrite--)  </div><div class="line">  &#123;</div><div class="line">    /* Send the current byte */</div><div class="line">    I2C_SendData(I2C1, *pBuffer); </div><div class="line"></div><div class="line">    /* Point to the next byte to be written */</div><div class="line">    pBuffer++; </div><div class="line">  </div><div class="line">    /* Test on EV8 and clear it */</div><div class="line">    while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_TRANSMITTED));</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  /* Send STOP condition */</div><div class="line">  I2C_GenerateSTOP(I2C1, ENABLE);</div><div class="line">&#125;</div><div class="line"></div><div class="line">void I2C_EE_WaitEepromStandbyState(void)      </div><div class="line">&#123;</div><div class="line">  vu16 SR1_Tmp = 0;</div><div class="line"></div><div class="line">  do</div><div class="line">  &#123;</div><div class="line">    /* Send START condition */</div><div class="line">    I2C_GenerateSTART(I2C1, ENABLE);</div><div class="line">    /* Read I2C1 SR1 register */</div><div class="line">    SR1_Tmp = I2C_ReadRegister(I2C1, I2C_Register_SR1);</div><div class="line">    /* Send EEPROM address for write */</div><div class="line">    I2C_Send7bitAddress(I2C1, EEPROM_ADDRESS, I2C_Direction_Transmitter);</div><div class="line">  &#125;while(!(I2C_ReadRegister(I2C1, I2C_Register_SR1) &amp; 0x0002));</div><div class="line">  </div><div class="line">  /* Clear AF flag */</div><div class="line">  I2C_ClearFlag(I2C1, I2C_FLAG_AF);</div><div class="line">  /* STOP condition */    </div><div class="line">  I2C_GenerateSTOP(I2C1, ENABLE); </div><div class="line">&#125;</div><div class="line"></div><div class="line">void I2C_EE_BufferRead(u8* pBuffer, u8 ReadAddr, u16 NumByteToRead)</div><div class="line">&#123;  </div><div class="line">  //*((u8 *)0x4001080c) |=0x80; </div><div class="line">    while(I2C_GetFlagStatus(I2C1, I2C_FLAG_BUSY)); // Added by Najoua 27/08/2008</div><div class="line">    </div><div class="line">    </div><div class="line">  /* Send START condition */</div><div class="line">  I2C_GenerateSTART(I2C1, ENABLE);</div><div class="line">  //*((u8 *)0x4001080c) &amp;=~0x80;</div><div class="line">  </div><div class="line">  /* Test on EV5 and clear it */</div><div class="line">  while(!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_MODE_SELECT));</div><div class="line"></div><div class="line">  /* Send EEPROM address for write */</div><div class="line">  I2C_Send7bitAddress(I2C1, EEPROM_ADDRESS, I2C_Direction_Transmitter);</div><div class="line"></div><div class="line">  /* Test on EV6 and clear it */</div><div class="line">  while(!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED));</div><div class="line">  </div><div class="line">  /* Clear EV6 by setting again the PE bit */</div><div class="line">  I2C_Cmd(I2C1, ENABLE);</div><div class="line"></div><div class="line">  /* Send the EEPROM'</span>s internal address to write to */</div><div class="line">  I2C_SendData(I2C1, ReadAddr);  </div><div class="line"></div><div class="line">  /* Test on EV8 and clear it */</div><div class="line">  <span class="keyword">while</span>(!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_TRANSMITTED));</div><div class="line">  </div><div class="line">  /* Send STRAT condition a second time */  </div><div class="line">  I2C_GenerateSTART(I2C1, ENABLE);</div><div class="line">  </div><div class="line">  /* Test on EV5 and clear it */</div><div class="line">  <span class="keyword">while</span>(!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_MODE_SELECT));</div><div class="line">  </div><div class="line">  /* Send EEPROM address <span class="keyword">for</span> <span class="built_in">read</span> */</div><div class="line">  I2C_Send7bitAddress(I2C1, EEPROM_ADDRESS, I2C_Direction_Receiver);</div><div class="line">  </div><div class="line">  /* Test on EV6 and clear it */</div><div class="line">  <span class="keyword">while</span>(!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_RECEIVER_MODE_SELECTED));</div><div class="line">  </div><div class="line">  /* While there is data to be <span class="built_in">read</span> */</div><div class="line">  <span class="keyword">while</span>(NumByteToRead)  </div><div class="line">  &#123;</div><div class="line">    <span class="keyword">if</span>(NumByteToRead == 1)</div><div class="line">    &#123;</div><div class="line">      /* Disable Acknowledgement */</div><div class="line">      I2C_AcknowledgeConfig(I2C1, DISABLE);</div><div class="line">      </div><div class="line">      /* Send STOP Condition */</div><div class="line">      I2C_GenerateSTOP(I2C1, ENABLE);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /* Test on EV7 and clear it */</div><div class="line">    <span class="keyword">if</span>(I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_RECEIVED))  </div><div class="line">    &#123;      </div><div class="line">      /* Read a byte from the EEPROM */</div><div class="line">      *pBuffer = I2C_ReceiveData(I2C1);</div><div class="line"></div><div class="line">      /* Point to the next location <span class="built_in">where</span> the byte <span class="built_in">read</span> will be saved */</div><div class="line">      pBuffer++; </div><div class="line">      </div><div class="line">      /* Decrement the <span class="built_in">read</span> bytes counter */</div><div class="line">      NumByteToRead--;        </div><div class="line">    &#125;   </div><div class="line">  &#125;</div><div class="line"></div><div class="line">  /* Enable Acknowledgement to be ready <span class="keyword">for</span> another reception */</div><div class="line">  I2C_AcknowledgeConfig(I2C1, ENABLE);</div><div class="line">&#125;</div><div class="line"></div><div class="line">void I2C_Test(void)</div><div class="line">&#123;</div><div class="line">  u16 i;</div><div class="line"></div><div class="line">  <span class="built_in">printf</span>(<span class="string">"写入的数据\n\r"</span>);</div><div class="line"></div><div class="line">  <span class="keyword">for</span> ( i=0; i&lt;=255; i++ ) //填充缓冲</div><div class="line">  &#123;   </div><div class="line">    I2c_Buf_Write[i] = i;  </div><div class="line">  &#125;</div><div class="line"></div><div class="line">  //将I2c_Buf_Write中顺序递增的数据写入EERPOM中 </div><div class="line">  I2C_EE_BufferWrite(I2c_Buf_Write, EEP_Firstpage, 256);	 </div><div class="line"></div><div class="line">  //将EEPROM读出数据顺序保持到I2c_Buf_Read中 </div><div class="line">  I2C_EE_BufferRead(I2c_Buf_Read, EEP_Firstpage, 256); </div><div class="line">&#125;</div></pre></td></tr></table></figure></div><p class="readmore"><a href="/2016/10/20/2016/2016-10-20-I2C通信详解/">Read More</a></p></div><div class="post"><h2 class="post-title"><a href="/2016/10/19/2016/2016-10-19-usb转串口/">usb转串口</a></h2><div class="post-meta">2016-10-19</div><a data-thread-key="2016/10/19/2016/2016-10-19-usb转串口/" href="/2016/10/19/2016/2016-10-19-usb转串口/#comments" class="ds-thread-count"></a><a data-disqus-identifier="2016/10/19/2016/2016-10-19-usb转串口/" href="/2016/10/19/2016/2016-10-19-usb转串口/#disqus_thread" class="disqus-comment-count"></a><div class="post-content"><p>使用单片机，对硬件编程的时候，可以说串口是最常用的交互方式，毕竟要安装一个显示器，显示屏等设备需要额外的开销，大量增加代码量，且很多场景并非必备外设。这篇文章将会详细的介绍单片机中最常使用的串口通信功能，这边通过<strong>多篇文章</strong>以51单片机和stm32为例，对串口（以ttl电平，232，485等）进行详细的论述。</p>
<p>在实验调试单片机时，串口相当重要以及常用，而现在电脑却一般仅有usb口（考虑到串口非专业人士不再使用）。因此我们在使用单片机读取串口数据时，往往需要<strong>将相应的串口转换为usb口</strong>。由于串口这边根据串口的不同，主要介绍常见的几种转接方式。</p>
<h3 id="串口ttl转usb"><a href="#串口ttl转usb" class="headerlink" title="串口ttl转usb"></a>串口ttl转usb</h3><p>常规调试过程中，我们可以将单片机ttl电平的串口信号TX和RX，通过转换芯片变成usb总线的信号。<strong>注意该过程既不是RS232也不是RS485，而是ttl的串口信号，该信号一般仅仅用来测试和下载，仅仅是方便使用而已。</strong></p>
<p>通常我们用来讲ttl串口信号转换为usb信号的芯片可以分为三种：FT232,CH340,PL2303，价位由高到低。这边我仅仅使用过CH340,PL2303这两款芯片的模块，对比后缺失PL2303误码率较高（当然不排除厂家因素）。一般情况我们使用CH340较多，相对稳定且价格便宜。实现的原理如下，其他集中芯片也大体一致：</p>
<p><img src="https://raw.githubusercontent.com/noparkinghere/noparkinghere.github.io/master/img/2016-10-19-usb%E8%BD%AC%E4%B8%B2%E5%8F%A3/1.png" alt=""></p>
<p>建议大家使用CH340的模块，价格也很便宜，这边给出完整的电路原理图：</p>
<p><img src="https://raw.githubusercontent.com/noparkinghere/noparkinghere.github.io/master/img/2016-10-19-usb%E8%BD%AC%E4%B8%B2%E5%8F%A3/2.jpg" alt=""></p></div><p class="readmore"><a href="/2016/10/19/2016/2016-10-19-usb转串口/">Read More</a></p></div><div class="post"><h2 class="post-title"><a href="/2016/10/19/2016/2016-10-19-串口RS232通信详解/">串口RS232通信详解</a></h2><div class="post-meta">2016-10-19</div><a data-thread-key="2016/10/19/2016/2016-10-19-串口RS232通信详解/" href="/2016/10/19/2016/2016-10-19-串口RS232通信详解/#comments" class="ds-thread-count"></a><a data-disqus-identifier="2016/10/19/2016/2016-10-19-串口RS232通信详解/" href="/2016/10/19/2016/2016-10-19-串口RS232通信详解/#disqus_thread" class="disqus-comment-count"></a><div class="post-content"><p>串行接口是一种可以将接受来自CPU的并行数据字符转换为连续的串行数据流发送出去，同时可将接受的串行数据流转换为并行的数据字符供给CPU的器件。一般完成这种功能的电路，我们称为串行接口电路。曾经PC之间进行串口通信可以说是标配，很多老式电脑上面可以看到DB25的接头，但后来逐渐被DB9取代，早期鼠标打印机都通过串口进行数据传输的，但现在逐渐被USB和网络所取代，DB9的串口接头在PC和笔记本上面也较少能够看到了。做嵌入式开发可以看到有个DB9的串口标准接口，串口对于开发人员输入输出调试等有着至关重要的作用。串行接口按电气标准及协议来分包括RS-232-C、RS-422、RS485等，现在串口一般在工业嵌入式领域使用。</p>
<p>波特率：单片机或计算机在串口通信时的速率。指的是信号被调制以后在单位时间内的变化，即单位时间内载波参数变化的次数，如每秒钟传送240个字符，而每个字符格式包含10位（1个起始位，1个停止位，8个数据位），这时的波特率为240Bd，比特率为10位*240个/秒=2400bps。（有单独文章详解）</p>
<p>数据位：数据位为5-8位，它紧跟在起始位之后，是被传送字符的有效数据位。传送时先传送字符的低位，后传送字符的高位。数据位究竟是几位，可由硬件或软件来设定。当然，一般8位为一个字节，通常都喜欢设置为8位数据位传输。</p>
<p>停止位：停止位为1位、1.5位或2位，可有软件设定。它一定是逻辑“1”电平，标志着传送一个字符的结束。</p>
<p>奇偶校验位：奇偶校验位仅占一位，用于进行奇校验或偶校验，也可以不设奇偶位。</p>
<p>同步通信和异步通信：异步通信是计算机通信中最常用的数据信息传输方式。它是以字符为单位进行传输的，字符之间没有固定的时间间隔要求，而每个字符中的各位则以固定的时间传送。</p>
<p>注意：<strong>串口发送数据是按位逐个发送的，且在传输字节的过程中是从字节的低位开始发送的。</strong></p></div><p class="readmore"><a href="/2016/10/19/2016/2016-10-19-串口RS232通信详解/">Read More</a></p></div><div class="post"><h2 class="post-title"><a href="/2016/10/19/2016-10-19-串口RS485通信详解/">串口RS485通信详解</a></h2><div class="post-meta">2016-10-19</div><a data-thread-key="2016/10/19/2016-10-19-串口RS485通信详解/" href="/2016/10/19/2016-10-19-串口RS485通信详解/#comments" class="ds-thread-count"></a><a data-disqus-identifier="2016/10/19/2016-10-19-串口RS485通信详解/" href="/2016/10/19/2016-10-19-串口RS485通信详解/#disqus_thread" class="disqus-comment-count"></a><div class="post-content"><p><strong>注意：串口发送数据是按位逐个发送的，且在传输字节的过程中是从字节的低位开始发送的。串口的一些内容不再逐一介绍说明，可以参加之前的usb转串口及RS232通信等文章</strong></p>
<h3 id="特性介绍"><a href="#特性介绍" class="headerlink" title="特性介绍"></a>特性介绍</h3><p>485（一般称作 RS485/EIA-485）是隶属于 OSI 模型物理层的电气特性规定为 2 线，半双工，多点通信的标准。它的电气特性和 RS-232 大不一样。用缆线两端的电压差值来表示传递信号。值得注意的是：RS485 仅仅规定了接受端和发送端的电气特性，它没有规定或推荐任何数据协议。</p>
<p><img src="https://raw.githubusercontent.com/noparkinghere/noparkinghere.github.io/master/img/2016-10-19-%E4%B8%B2%E5%8F%A3RS485%E9%80%9A%E4%BF%A1%E8%AF%A6%E8%A7%A3/1.jpg" alt=""></p>
<p>RS485接口可以只使用两根线进行通讯（其他串口通讯至少需要三根线，一根为地线作为参考电平），通过差分电平（利用两个信号的差值来判断信息，使用差分信号来传输的，也就是一根线传同相信号，一根线传反相，这样差值最大，抗干扰能力强。）来确定信号是0还是1，也正因为这个原因，所以RS485每次有且仅有一根线能够传输数据，另外一根线作为比对信号，因此RS485是半双工的通讯方式。主要特点如下：</p>
<p><img src="https://raw.githubusercontent.com/noparkinghere/noparkinghere.github.io/master/img/2016-10-19-%E4%B8%B2%E5%8F%A3RS485%E9%80%9A%E4%BF%A1%E8%AF%A6%E8%A7%A3/2.jpg" alt=""></p>
<ul>
<li>接口电平低，不易损坏芯片。 RS485 的电气特性：逻辑“ 1”以两线间的电压差为+(2~6)V<br>表示；逻辑“ 0”以两线间的电压差为-(2~6)V 表示。接口信号电平比 RS232 降低了，<br>不易损坏接口电路的芯片，且该电平与 TTL 电平兼容，可方便与 TTL 电路连接。</li>
<li>传输速率高。 10 米时， RS485 的数据最高传输速率可达 35Mbps，在 1200m 时，传输<br>速度可达 100Kbps。</li>
<li>抗干扰能力强。 RS485 接口是采用平衡驱动器和差分接收器的组合，抗共模干扰能力<br>增强，即抗噪声干扰性好。 传输距离远，支持节点多。 RS485 总线最长可以传输 1200m<br>以上（速率≤100Kbps）</li>
<li>一般最大支持 32 个节点，如果使用特制的 485 芯片，可以达到 128 个或者 256 个节点，<br>最大的可以支持到 400 个节点。</li>
</ul></div><p class="readmore"><a href="/2016/10/19/2016-10-19-串口RS485通信详解/">Read More</a></p></div><div class="post"><h2 class="post-title"><a href="/2016/10/18/2016/2016-10-18-ubuntu关闭笔记本触摸板/">ubuntu关闭笔记本触摸板</a></h2><div class="post-meta">2016-10-18</div><a data-thread-key="2016/10/18/2016/2016-10-18-ubuntu关闭笔记本触摸板/" href="/2016/10/18/2016/2016-10-18-ubuntu关闭笔记本触摸板/#comments" class="ds-thread-count"></a><a data-disqus-identifier="2016/10/18/2016/2016-10-18-ubuntu关闭笔记本触摸板/" href="/2016/10/18/2016/2016-10-18-ubuntu关闭笔记本触摸板/#disqus_thread" class="disqus-comment-count"></a><div class="post-content"><p><em>ubuntu 16.04的版本中，试过多个笔记本都可以通过键盘的快捷按键关闭触摸板的使用，但仍然显得不够智能，因为缺乏相关的程序和驱动，无法做到自动选择触摸板和鼠标。另外虽然我用的是ubuntu的系统但因为没有使用它的WM所以触摸板无法直接禁用，必须通过手动的方式才可以实现。</em></p>
<p>本文搜集了一些比较通用的触摸板禁用方式，另外后续如果找到更好的方法，还会补充上来。以下在dell的超极本和msi的游戏本上面实现过，且实验环境是ubuntu 16.04，其他系统和笔记本不能确保一定可以实现。</p>
<h3 id="详细步骤："><a href="#详细步骤：" class="headerlink" title="详细步骤："></a>详细步骤：</h3><h4 id="方法1："><a href="#方法1：" class="headerlink" title="方法1："></a>方法1：</h4><ul>
<li>sudo rmmod psmouse    这个是禁用触摸板</li>
<li>sudo modprobe psmouse 这个是启用触摸板</li>
</ul>
<p>方式简单快捷，但是会将触点和触板都禁用了，一般还是希望保持触点是启用的，且仅有启用和禁用的两个功能，每次需要指令才可以实现，无法做到智能识别鼠标自动启用禁用。</p></div><p class="readmore"><a href="/2016/10/18/2016/2016-10-18-ubuntu关闭笔记本触摸板/">Read More</a></p></div><div class="post"><h2 class="post-title"><a href="/2016/10/18/2016/2016-10-18-计算机中的通信简介/">计算机中的通信简介</a></h2><div class="post-meta">2016-10-18</div><a data-thread-key="2016/10/18/2016/2016-10-18-计算机中的通信简介/" href="/2016/10/18/2016/2016-10-18-计算机中的通信简介/#comments" class="ds-thread-count"></a><a data-disqus-identifier="2016/10/18/2016/2016-10-18-计算机中的通信简介/" href="/2016/10/18/2016/2016-10-18-计算机中的通信简介/#disqus_thread" class="disqus-comment-count"></a><div class="post-content"><p>计算机从最初发展到现在已经有半个多世纪的历史，众所周知其实计算机就是一堆电路的组成，传统最为通用的计算功能仅仅是控制高低电平，输入输出（0和1）。而计算机中的CPU和其他设备如内存，硬盘，主板的其他电路连接过程中，控制的过程就是通过相关的通信协议，让一堆的高低电平输入输出最终可以转化为我们我们工作需要的内容，而赋予这些0,1实际意义的就是通信协议。计算机中有着众多的通信协议，有些协议已经逐渐被淘汰，而另外一些经过这么多年的发展仍然在各行各业经久不衰，一些更新更稳定更满足这个时代需求的协议也正在被越来越多的智能设备移动设备所采纳。本文仅仅是简要的叙述计算机嵌入式中最常用的一些协议。</p>
<p>这边如果对码元，波特率等还不是恨清除的可以参考<strong>传输速率</strong>这篇文章。</p>
<p><em>在了解通信协议和传输前，得先弄明白：总线和协议，串行传输和并行传输，同步通信和异步通信，全双工和半双工等基本概念，至于具体的通信方式和协议，这边仅作简述，有单独文章进行具体阐述。</em></p>
<h3 id="总线和协议"><a href="#总线和协议" class="headerlink" title="总线和协议"></a>总线和协议</h3><p>在展开讲解之前，先来区分两个概念：总线和协议。</p>
<p><strong>总线</strong>是一组信号线的集合，它定义了各引线的信号、电机、机械特性，使计算机内部各组成部分之间以及不同的计算机之间建立信号联系，进行信息传送和通信，按照作用范围简单来分可以分为内部总线和外部总线。内部总线：就是计算机内部功能模板之间进行通信的总线，它是构成完整的计算机系统的内部信息枢纽，但按功能仍要分为数据总线DB，地址总线AB，控制总线CB，电源总线PB。外部总线是计算机与计算机之间或计算机与其他智能设备之间进行通信的连接。但随着嵌入式不断的发展，现在在两者的区分已经不是那么严格，USB的传输可以认作是外部串行传输方式，而传统所认为是内部穿行传输方式的IIC现在也被一些外接的传感器所使用，因此在嵌入式领域已经无需再纠结是内部总线还是外部总线，毕竟为了满足需求很多原有的协议已经进行的改进使得传输距离更远，抗干扰性更强了，也有更多曾经的内部总线被在外部所使用了。</p>
<p>通信协议是指双方实体完成通信或服务所必须遵循的规则和约定。协议定义了数据单元使用的格式，信息单元应该包含的信息与含义，连接方式，信息发送和接收的时序，从而确保在通信过程中数据顺利地传送到确定的地方。</p>
<p><em>因为总线的种类实在太多，各种总线的衍生品层出不穷，这边就不详细列举，以下仅仅将目前嵌入式/微机上面最为常见的通信方式列举出来。</em></p></div><p class="readmore"><a href="/2016/10/18/2016/2016-10-18-计算机中的通信简介/">Read More</a></p></div><div class="post"><h2 class="post-title"><a href="/2016/10/17/2016/2016-10-17-杂谈小纪/">杂谈小纪</a></h2><div class="post-meta">2016-10-17</div><a data-thread-key="2016/10/17/2016/2016-10-17-杂谈小纪/" href="/2016/10/17/2016/2016-10-17-杂谈小纪/#comments" class="ds-thread-count"></a><a data-disqus-identifier="2016/10/17/2016/2016-10-17-杂谈小纪/" href="/2016/10/17/2016/2016-10-17-杂谈小纪/#disqus_thread" class="disqus-comment-count"></a><div class="post-content"><p>2016转眼又快结束，这个月加上国庆休假一下子又过去了半个多月，直到今天才开始上班。今年除了工作上面的几个项目进一步完善外，这边为16年最后几个月制定一个小计划：</p>
<ul>
<li>按照自己的风格，为神州王开发板写一套完整的学习案例，并同步到github。</li>
<li>学习研究python，以视频文档和案例学习为主。</li>
<li>装修自己的blog</li>
</ul></div><p class="readmore"><a href="/2016/10/17/2016/2016-10-17-杂谈小纪/">Read More</a></p></div><div class="post"><h2 class="post-title"><a href="/2016/10/16/2016/2016-10-16-note-7-的一些个人看法/">Note 7 的一些个人看法</a></h2><div class="post-meta">2016-10-16</div><a data-thread-key="2016/10/16/2016/2016-10-16-note-7-的一些个人看法/" href="/2016/10/16/2016/2016-10-16-note-7-的一些个人看法/#comments" class="ds-thread-count"></a><a data-disqus-identifier="2016/10/16/2016/2016-10-16-note-7-的一些个人看法/" href="/2016/10/16/2016/2016-10-16-note-7-的一些个人看法/#disqus_thread" class="disqus-comment-count"></a><div class="post-content"><p><em>本文是一篇杂谈笔记，一直比较关注科技圈多年，喜欢各种电子产品，且能够DIY或者修理一些小东西，虽然对三星这家公司一直缺乏好感，但还是吐槽一番。</em></p>
<p><img src="https://raw.githubusercontent.com/noparkinghere/noparkinghere.github.io/master/img/2016-10-16-note-7-%E7%9A%84%E4%B8%80%E4%BA%9B%E4%B8%AA%E4%BA%BA%E7%9C%8B%E6%B3%95/1.jpg" alt=""></p>
<p>最近闹的比较火的三星Note 7手榴弹事件，终于在这两天落下了帷幕，最终三星将中国市场和海外市场同等对待，停售并回收所有该款机型，无需退还相关赠送配件，允许用户退换或者置换手机，并作出一系列相关补偿。事情看起来似乎是皆大欢喜，恶势力最终向国人低头。</p>
<p>但换而言之，通过三星的一些列举动不得不说是：<strong>搬起石头砸自己的脚</strong>。首先三星和苹果一直是占据高端手机市场几乎所有份额的，三星早些时候在12年以前可以说是国内最最畅销的手机厂家。原因是：产品线广，覆盖低中高多个销售人群，品牌大众认可度高，国内缺乏有力的竞争对手，那时候小米，华为等也才刚刚起步没多久。三星的衰亡也恰恰因为这些原因，首先，13年以后，国内主打性价比性能的手机层出不穷，而三星天然的重广告轻研发的基因，也让它的中低端机型用户体验奇差无比。国内中低端市场逐渐被国产手机厂家占领，三星从此排名一落千丈，且这几年似乎已经从中国主流消费者眼中销声匿迹了。</p></div><p class="readmore"><a href="/2016/10/16/2016/2016-10-16-note-7-的一些个人看法/">Read More</a></p></div><div class="post"><h2 class="post-title"><a href="/2016/10/09/2016-10-09-多种电平的区分/">多种电平的区分</a></h2><div class="post-meta">2016-10-09</div><a data-thread-key="2016/10/09/2016-10-09-多种电平的区分/" href="/2016/10/09/2016-10-09-多种电平的区分/#comments" class="ds-thread-count"></a><a data-disqus-identifier="2016/10/09/2016-10-09-多种电平的区分/" href="/2016/10/09/2016-10-09-多种电平的区分/#disqus_thread" class="disqus-comment-count"></a><div class="post-content"><p><strong>电平</strong>就是指电路中两点或几点在相同阻抗下电量的相对比值，即电量水平。常用逻辑电平：有TTL、CMOS、LVTTL、ECL、PECL、GTL；RS232、RS422、LVDS等。</p>
<h3 id="TTL电平"><a href="#TTL电平" class="headerlink" title="TTL电平"></a>TTL电平</h3><p>TTL和CMOS的逻辑电平按典型电压可分为四类：5V系列（5V TTL和5V CMOS）、3.3V系列，2.5V系列和1.8V系列。</p>
<ul>
<li>5V TTL和5V CMOS逻辑电平是通用的逻辑电平。</li>
<li>3.3V及以下的逻辑电平被称为低电压逻辑电平，常用的为LVTTL电平。</li>
<li>低电压的逻辑电平还有2.5V和1.8V两种。</li>
</ul></div><p class="readmore"><a href="/2016/10/09/2016-10-09-多种电平的区分/">Read More</a></p></div><nav class="page-navigator"><a class="extend prev" rel="prev" href="/page/9/">Previous</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span><a class="page-number" href="/page/11/">11</a><a class="page-number" href="/page/12/">12</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><a class="extend next" rel="next" href="/page/11/">Next</a></nav><script id="dsq-count-scr" src="//noparkinghere.disqus.com/count.js" async></script></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/个人观点/">个人观点</a><span class="category-list-count">26</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/学习提高/">学习提高</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/杂谈/">杂谈</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/生活杂谈/">生活杂谈</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/程序开发/">程序开发</a><span class="category-list-count">26</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/转载文章/">转载文章</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/软件应用/">软件应用</a><span class="category-list-count">70</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/问题总结/">问题总结</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/IDE/" style="font-size: 15px;">IDE</a> <a href="/tags/嵌入式/" style="font-size: 15px;">嵌入式</a> <a href="/tags/英语/" style="font-size: 15px;">英语</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/网络/" style="font-size: 15px;">网络</a> <a href="/tags/服务器/" style="font-size: 15px;">服务器</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/VPS/" style="font-size: 15px;">VPS</a> <a href="/tags/chrome/" style="font-size: 15px;">chrome</a> <a href="/tags/版本控制/" style="font-size: 15px;">版本控制</a> <a href="/tags/配置/" style="font-size: 15px;">配置</a> <a href="/tags/基础/" style="font-size: 15px;">基础</a> <a href="/tags/使用体验/" style="font-size: 15px;">使用体验</a> <a href="/tags/系统安装/" style="font-size: 15px;">系统安装</a> <a href="/tags/问题总结/" style="font-size: 15px;">问题总结</a> <a href="/tags/githubpage/" style="font-size: 15px;">githubpage</a> <a href="/tags/C语言/" style="font-size: 15px;">C语言</a> <a href="/tags/学习方法/" style="font-size: 15px;">学习方法</a> <a href="/tags/手机/" style="font-size: 15px;">手机</a> <a href="/tags/基础知识/" style="font-size: 15px;">基础知识</a> <a href="/tags/ssh/" style="font-size: 15px;">ssh</a> <a href="/tags/vps/" style="font-size: 15px;">vps</a> <a href="/tags/文档/" style="font-size: 15px;">文档</a> <a href="/tags/调试/" style="font-size: 15px;">调试</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Blogroll</i></div><ul></ul><a href="https://news.ycombinator.com/" title="Hacker News" target="_blank">Hacker News</a><ul></ul><a href="http://blog.jobbole.com/" title="Jobbole" target="_blank">Jobbole</a><ul></ul><a href="http://www.ruanyifeng.com/blog/" title="阮一峰的网络日志" target="_blank">阮一峰的网络日志</a><ul></ul><a href="http://www.panxw.com/" title="潘学文个人博客" target="_blank">潘学文个人博客</a><ul></ul><a href="https://www.haomwei.com/" title="屠城" target="_blank">屠城</a><ul></ul><a href="https://blog.0xbbc.com/" title="3004" target="_blank">3004</a><ul></ul><a href="https://emiria.io/" title="Sakara Hiroya" target="_blank">Sakara Hiroya</a></div><div class="widget"><div class="comments-title"><i class="fa fa-comment-o"> Recent Comments</i></div><div data-num-items="5" data-show-avatars="0" data-show-time="1" data-show-admin="0" data-excerpt-length="32" data-show-title="1" class="ds-recent-comments"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> Recent Comments</i></div><script type="text/javascript" src="//noparkinghere.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">Damon's Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>var duoshuoQuery = {short_name:'noparkinghere'};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
        || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-80280728-1','auto');ga('send','pageview');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>